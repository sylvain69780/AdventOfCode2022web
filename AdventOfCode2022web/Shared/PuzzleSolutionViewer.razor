@using System.Collections.ObjectModel;
@if (Page is not null)
{
    <h3>View the code of the solution</h3>
    <p class="form-label">No code viewer here, view the solution directly on <a href=@Page.PuzzleSolutionCode>GitHub</a>.</p>
    <h3>Puzzle Input</h3>
    <div>
        <label class="form-label">The data below is what is provided as example in the problem statement. You can paste your own user input.</label>
        <button class="btn-primary" @onclick=Page.LoadDefaultPuzzleInput>Load default puzzle input</button>
        <button class="btn-primary" @onclick=Page.LoadFullPuzzleInput>Load a full puzzle input</button>
        <pre><textarea spellcheck="false" class="form-control" aria-label="Puzzle Input" rows="10" @bind="Page.Input" maxlength="10000000"></textarea></pre>
    </div>
    <h3>Puzzle Controler</h3>
    <div class="container mt-2">
        <div class="alert alert-info">
            <strong>Information:</strong> @_message[Page.PageState]
        </div>
    </div>
    <button disabled=@(Page.PageState == PageState.Processing || Page.PageState == PageState.ProcessingAuto) @onclick=@Page.StartPart1>Initialize Part 1</button>
    <button disabled=@(Page.PageState == PageState.Processing || Page.PageState == PageState.ProcessingAuto) @onclick=@Page.StartPart2>Initialize Part 2</button>
    <button disabled=@(Page.PageState != PageState.Processing) @onclick=@Page.MoveNext>Move to next Step</button>
    <button disabled=@(Page.PageState != PageState.Processing) @onclick=@Page.MoveUntilCompleted>Move until completed</button>
    <button disabled=@(Page.PageState != PageState.Processing && Page.PageState != PageState.ProcessingAuto) @onclick=@Page.Stop>Stop</button>
    <p>Step @Page.SolvingStep</p>
    <div class="row">
        <input type="range" id="delayRange" @bind=Page.AnimationDuration min="0" max="5000" step="50">
        @if (Page.AnimationDuration == 0)
        {
            <label class="form-label" for="delayRange">High performance solving mode !</label>
        }
        else
        {
            <label class="form-label" for="delayRange">Run a step every @Page.AnimationDuration ms</label>
        }
    </div>
    <h3>Output</h3>
    <p><pre>@Page.Result</pre></p>
}

@code {
    [Parameter]
    public IPuzzleSolutionPage? Page { get; set; }

    private readonly ReadOnlyDictionary<PageState, string> _message = new ReadOnlyDictionary<PageState, string>(new Dictionary<PageState,string>
    {
        {PageState.Loaded,"Click to start solving one of the the parts." },
        {PageState.Finished,"Solution found ! Please check the output value." },
        {PageState.Processing,"Click to run the next step, adjust the animation speed using the slider." },
        {PageState.ProcessingAuto,"Adjust processing speed using the slider. Zero means no delay." }
    });
}
